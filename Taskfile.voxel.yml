version: '3'

vars:
  SRC_DIR: .src
  VOXEL_DIR: '{{.SRC_DIR}}/voxel-fun'
  VOXEL_REPO: https://github.com/pawel-dubiel/voxel-fun.git

tasks:
  clone:
    desc: Clone voxel-fun repository
    status:
      - test -d {{.VOXEL_DIR}}
    cmds:
      - mkdir -p {{.SRC_DIR}}
      - git clone {{.VOXEL_REPO}} {{.VOXEL_DIR}}

  pull:
    desc: Pull latest voxel-fun changes
    dir: '{{.VOXEL_DIR}}'
    cmds:
      - git pull

  deps:install:
    desc: Install voxel-fun dependencies
    dir: '{{.VOXEL_DIR}}'
    deps:
      - clone
    cmds:
      - bun install

  deps:clean:
    desc: Remove voxel-fun source directory
    cmds:
      - rm -rf {{.SRC_DIR}}

  run:
    desc: Run voxel-fun visualizer
    dir: '{{.VOXEL_DIR}}'
    deps:
      - deps:install
    cmds:
      - bun run dev
